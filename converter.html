<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FOLNEB | Document Automation Workspace</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="main.css" />
  </head>

  <body class="page page--workspace">
    <header class="site-header">
      <div class="container header-content">
        <a class="logo" href="index.html">FOLNEB</a>
        <nav class="site-nav" aria-label="Main navigation">
          <ul>
            <li><a href="index.html">Overview</a></li>
            <li><a href="home.html">Product Tour</a></li>
            <li><a href="converter.html" aria-current="page">Workspace</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main>
      <section class="workspace" aria-labelledby="workspace-heading">
        <div class="container workspace__layout">
          <div class="workspace__primary">
            <header class="workspace__intro">
              <h1 id="workspace-heading">Select a conversion to get started</h1>
              <p class="lead">
                The FOLNEB workspace runs real client-side conversions, PDF prep, and optimization flows. Choose a conversion, upload a file, and tailor the optional enhancements below.
              </p>
            </header>

            <form class="converter-card" id="converterForm">
              <fieldset>
                <legend class="visually-hidden">Document conversion upload form</legend>

                <div class="conversion-selector">
                  <label for="conversionType">Choose a conversion or automation</label>
                  <div class="select-wrapper">
                    <select id="conversionType" name="conversionType" class="conversion-select">
                      <option value="word-to-pdf">Word to PDF</option>
                      <option value="ppt-to-pdf">PowerPoint to PDF</option>
                      <option value="xls-to-pdf">Excel to PDF</option>
                      <option value="image-to-pdf">Images to PDF</option>
                      <option value="pdf-to-word">PDF to Word</option>
                      <option value="pdf-to-ppt">PDF to PowerPoint</option>
                      <option value="pdf-merge">Merge PDFs</option>
                      <option value="pdf-split">Split PDF</option>
                      <option value="pdf-compress">Compress PDF</option>
                      <option value="pdf-sign">Prep for e-sign</option>
                      <option value="pdf-ocr">OCR a scanned PDF</option>
                    </select>
                  </div>
                  <p class="conversion-summary" id="conversionSummary">Word → PDF — Preserve your document formatting and fonts.</p>
                </div>

                <div class="file-input">
                  <label class="file-label" for="sourceFile">
                    <span class="file-label-text" id="fileLabelText">Select a Word document</span>
                    <span class="file-hint" id="fileHint">Supported formats: .docx</span>
                  </label>
                  <input type="file" id="sourceFile" name="sourceFile" />
                  <p class="file-name" id="fileName">No file selected yet.</p>
                </div>

                <div class="advanced-options" aria-live="polite">
                  <h2>Optional enhancements</h2>
                  <ul id="advancedOptions" class="advanced-options__list"></ul>
                  <p id="advancedNote" class="advanced-options__note"></p>
                </div>

                <button type="submit" id="convertBtn" class="btn btn-primary">Convert to PDF</button>
              </fieldset>
            </form>

            <div class="progress">
              <div id="spinner" class="spinner" role="status" aria-live="polite" aria-hidden="true" hidden>
                <span class="visually-hidden">Processing your document…</span>
              </div>
              <div id="result" class="result" role="status" aria-live="polite"></div>
            </div>
          </div>

          <aside class="workspace__aside" aria-label="Workspace resources">
            <section class="workspace-panel">
              <h2>Recipe guide</h2>
              <p>Deep links launch the workspace with the proper configuration. Use them to demo or bookmark your most common flows.</p>
              <div class="quick-links">
                <a href="converter.html?type=word-to-pdf">Word → PDF</a>
                <a href="converter.html?type=pdf-to-word">PDF → Word</a>
                <a href="converter.html?type=pdf-merge">Merge PDFs</a>
                <a href="converter.html?type=pdf-compress">Compress PDF</a>
                <a href="converter.html?type=pdf-ocr">OCR PDF</a>
              </div>
            </section>

            <section class="workspace-panel">
              <h2>Recent Conversions</h2>
              <ul id="recentJobs" class="panel-list"></ul>
            </section>

            <section class="workspace-panel workspace-panel--muted">
              <h2>Status snapshot</h2>
              <dl class="status-grid">
                <div>
                  <dt>Recipes enabled</dt>
                  <dd>11</dd>
                </div>
                <div>
                  <dt>Client-only</dt>
                  <dd>Yes</dd>
                </div>
                <div>
                  <dt>Worker support</dt>
                  <dd>Tesseract / PDF.js</dd>
                </div>
              </dl>
            </section>

            <section class="workspace-panel">
              <h2>Cloud import/export</h2>
              <p>Import files from your cloud drive (stubs to wire up):</p>
              <div class="cta-group">
                <button type="button" id="importDriveBtn" class="btn btn-outline">Import from Google Drive</button>
                <button type="button" id="importOneDriveBtn" class="btn btn-outline">Import from OneDrive</button>
              </div>
            </section>

            <section class="workspace-panel">
              <h2>Account</h2>
              <div class="cta-group">
                <button type="button" id="signInBtn" class="btn btn-primary">Sign in with Google</button>
                <button type="button" id="signOutBtn" class="btn btn-outline">Sign out</button>
              </div>
              <p id="accountStatus" class="file-hint" aria-live="polite"></p>
            </section>
          </aside>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container footer-content">
        <p>&copy; <span id="workspaceYear"></span> FOLNEB. All rights reserved.</p>
        <a href="home.html" class="footer-link">Explore the tour</a>
      </div>
    </footer>

    <script>
      document.getElementById('workspaceYear').textContent = new Date().getFullYear();
    </script>

    <!-- ===== VENDOR LIBS (CDN) ===== -->
    <!-- PDF.js + worker -->
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
    <script>
      if (window.pdfjsLib) {
        pdfjsLib.GlobalWorkerOptions.workerSrc =
          'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js';
      }
    </script>

    <!-- html2canvas (REQUIRED for jsPDF doc.html) -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    <!-- PDF creation + utilities -->
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

    <!-- Converters -->
    <script src="https://cdn.jsdelivr.net/npm/mammoth/mammoth.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jszip/dist/jszip.min.js"></script>

    <!-- ===== APP SCRIPTS (after vendors) ===== -->
    <script src="main.js"></script>
    <script src="converter.js"></script>

    <!-- Preview Modal -->
    <div id="previewModal" class="modal" hidden>
      <div class="modal__backdrop" id="previewBackdrop"></div>
      <div class="modal__content" role="dialog" aria-modal="true" aria-labelledby="previewTitle">
        <header class="modal__header">
          <h2 id="previewTitle">Preview</h2>
          <button type="button" id="previewClose" class="btn btn-outline">Close</button>
        </header>
        <div class="modal__body">
          <canvas id="previewCanvas"></canvas>
        </div>
        <footer class="modal__footer">
          <button type="button" id="previewPrev" class="btn btn-outline">Prev</button>
          <span id="previewPageInfo" class="file-hint"></span>
          <button type="button" id="previewNext" class="btn btn-outline">Next</button>
        </footer>
      </div>
    </div>
  </body>
</html>
